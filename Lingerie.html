<style>
    :root { --primary: #8da399; --accent: #d4a373; --bg: #f9f7f2; --card-bg: #ffffff; --border: #e0dcd0; --danger: #e53e3e; --success: #48bb78; }
    body { font-family: -apple-system, "Noto Sans TC", sans-serif; background: var(--bg); margin: 0; padding: 10px; color: #444; }
    .container { max-width: 600px; margin: auto; }
    .card { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid var(--border); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    h3 { color: #6b7e75; border-left: 4px solid var(--accent); padding-left: 10px; margin: 0 0 15px 0; font-size: 1rem; }
    .field { display: flex; flex-direction: column; gap: 5px; margin-bottom: 12px; width: 100%; }
    .row-inputs { display: flex; gap: 8px; margin-bottom: 10px; flex-wrap: wrap; }
    input, select { flex: 1; min-width: 80px; padding: 12px; font-size: 16px; border: 1px solid var(--border); border-radius: 8px; box-sizing: border-box; background: #fff; height: 48px; }
    optgroup { font-weight: bold; color: #6b7e75; background: #f0f2f1; }
    button { width: 100%; padding: 14px; font-size: 16px; border: none; border-radius: 8px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; transition: 0.2s; }
    button:active { opacity: 0.7; }
    .btn-accent { background: var(--accent); }
    .btn-success { background: var(--success); }
    .btn-danger { background: var(--danger); }
    #scanner-container { display: none; margin-bottom: 15px; background: #000; border-radius: 12px; overflow: hidden; position: relative; }
    #scan-feedback { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(72, 187, 120, 0.9); color: white; padding: 5px 25px; border-radius: 20px; font-weight: bold; z-index: 10; display: none; }
    
    #print-preview-zone { margin-top: 15px; padding: 15px; border: 2px dashed var(--accent); border-radius: 8px; display: none; background: white; }
    .table-wrapper { overflow-x: auto; border-radius: 8px; border: 1px solid #eee; margin-top: 10px; }
    table { width: 100%; border-collapse: collapse; background: #fff; min-width: 450px; font-size: 0.85rem; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #f9f9f9; }
    .tag { background: #f0f2f1; padding: 6px 10px; border-radius: 6px; font-size: 0.8rem; border: 1px solid #e0e5e3; display: flex; align-items: center; }
    .tag span { margin-left: 8px; color: var(--danger); font-weight: bold; cursor: pointer; }
    .scan-mode-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px; }
    .mode-btn { font-size: 0.85rem; padding: 10px 5px; border: 2px solid transparent; opacity: 0.8; }
    .mode-active { border-color: #333; opacity: 1; outline: 3px solid #000; transform: scale(0.98); }

    #print-label-page, #print-invoice-page { display: none; }

    /* --- 列印優化版 --- */
    @media print {
        .no-print { display: none !important; }
        body { background: white; margin: 0; padding: 0; overflow: hidden; }
        @page { margin: 0; size: A4 portrait; }

        /* 標籤模式：移除強制分頁，限制總高度 */
        #print-label-page { 
            display: grid !important; 
            grid-template-columns: repeat(5, 38mm); 
            grid-template-rows: repeat(7, 38mm);
            column-gap: 2.5mm; 
            row-gap: 0mm; 
            padding-left: 6.5mm; 
            padding-top: 15.5mm; 
            box-sizing: border-box;
            height: 297mm; /* A4 標準高度 */
            overflow: hidden;
            page-break-after: avoid;
        }
        .label-item {
            width: 38mm; height: 38mm;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            overflow: hidden; text-align: center; color: black; line-height: 1.2;
            box-sizing: border-box;
        }
        .label-item canvas { width: 22mm !important; height: 22mm !important; }
        .label-item .txt { font-size: 7.5pt; font-weight: bold; margin-top: 1mm; }

        /* 出貨單模式 */
        #print-invoice-page { 
            display: block !important; 
            padding: 15mm; 
            height: auto;
            page-break-after: avoid;
        }
        .inv-table { width: 100%; border-collapse: collapse; }
        .inv-table th, .inv-table td { border: 1px solid black; padding: 8px; }
    }
</style>
