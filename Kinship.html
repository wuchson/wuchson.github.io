<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>八親等全自動計算器</title>
    <style>
        :root { --primary: #6c5ce7; --bg: #f8f9fd; }
        body { font-family: sans-serif; background: var(--bg); padding: 20px; }
        .screen { background: white; border-radius: 20px; padding: 30px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.05); min-height: 200px; margin-bottom: 20px; }
        .path { color: #a29bfe; font-size: 0.9rem; margin-bottom: 10px; }
        .ans { font-size: 2.2rem; font-weight: bold; color: #2d3436; }
        .badge { background: #eeeafb; color: var(--primary); padding: 5px 15px; border-radius: 10px; font-size: 0.8rem; margin-top: 15px; display: inline-block; font-weight: bold; }
        .keypad { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 500px; margin: 0 auto; }
        .key { aspect-ratio: 1.2; border: none; background: white; border-radius: 15px; font-weight: bold; font-size: 1.1rem; box-shadow: 0 3px 6px rgba(0,0,0,0.05); cursor: pointer; }
        .key.op { background: #f1f0ff; color: var(--primary); }
    </style>
</head>
<body>

<div class="screen">
    <div id="path" class="path">請開始輸入組合...</div>
    <div id="ans" class="ans">自己</div>
    <div id="deg" class="badge" style="display:none;"></div>
</div>

<div class="keypad">
    <button class="key op" onclick="add('父')">父</button>
    <button class="key op" onclick="add('母')">母</button>
    <button class="key" onclick="back()">退格</button>
    <button class="key" style="color:red" onclick="reset()">歸零</button>
    <button class="key" onclick="add('兄')">兄</button>
    <button class="key" onclick="add('弟')">弟</button>
    <button class="key" onclick="add('姐')">姐</button>
    <button class="key" onclick="add('妹')">妹</button>
    <button class="key op" onclick="add('夫')">夫</button>
    <button class="key op" onclick="add('妻')">妻</button>
    <button class="key op" onclick="add('子')">子</button>
    <button class="key op" onclick="add('女')">女</button>
</div>

<script>
    let stack = [];
    const upNames = ["父", "祖父", "曾祖", "高祖", "天祖", "烈祖", "太祖", "遠祖"];
    const downNames = ["子", "孫", "曾孫", "玄孫", "來孫", "晜孫", "仍孫", "雲孫"];

    function add(r) { if(stack.length < 15) stack.push(r); update(); }
    function back() { stack.pop(); update(); }
    function reset() { stack = []; update(); }

    function update() {
        const pathEl = document.getElementById('path');
        const ansEl = document.getElementById('ans');
        const degEl = document.getElementById('deg');

        if (stack.length === 0) {
            pathEl.innerText = "請開始輸入..."; ansEl.innerText = "自己";
            degEl.style.display = "none"; return;
        }

        pathEl.innerText = "我的 " + stack.join(' 的 ');
        
        let up = 0, down = 0, isSide = false;
        stack.forEach(r => {
            if(['父','母'].includes(r)) up++;
            else if(['子','女'].includes(r)) down++;
            else if(['兄','弟','姐','妹'].includes(r)) { up++; down++; isSide = true; }
        });

        let res = "親戚";
        if(up > 0 && down === 0) res = (upNames[up-1] || "遠祖") + (stack[stack.length-1] === '母' ? "母" : "父");
        else if(down > 0 && up === 0) res = (downNames[down-1] || "遠孫");
        else if(isSide) {
            if(up+down === 2) res = "親兄弟姊妹";
            else if(up+down === 3) res = up > down ? (stack.includes('母')?'舅舅/姨媽':'伯叔姑') : '姪甥';
            else res = (up+down) + "親等旁系";
        }

        ansEl.innerText = res;
        degEl.innerText = (up + down) + " 親等";
        degEl.style.display = "inline-block";
    }
</script>
</body>
</html>
