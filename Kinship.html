<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE KINSHIP | 終極親屬百科</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: rgba(255, 255, 255, 0.9);
            --primary-dark: #1a2a6c;
            --accent-gold: #b8860b;
            --accent-rose: #e94e77;
            --text-main: #2d3436;
            --glass-border: rgba(255, 255, 255, 0.3);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        body {
            font-family: "PingFang TC", "Helvetica Neue", sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 40px 20px;
            color: var(--text-main);
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            margin: auto;
        }

        /* 時尚標題 */
        header {
            text-align: center;
            margin-bottom: 50px;
        }

        header h1 {
            font-weight: 300;
            letter-spacing: 8px;
            text-transform: uppercase;
            color: var(--primary-dark);
            margin-bottom: 10px;
        }

        header p {
            font-weight: 300;
            color: #636e72;
            letter-spacing: 2px;
        }

        /* 玻璃擬態卡片 */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--accent-gold);
            margin-bottom: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        /* 智能按鈕設計 */
        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        button.node {
            background: white;
            border: 1px solid #eee;
            padding: 15px 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            color: var(--primary-dark);
        }

        button.node:hover {
            background: var(--primary-dark);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .btn-reset {
            background: #fdf2f2 !important;
            color: var(--accent-rose) !important;
            border: 1px solid #f9dada !important;
        }

        /* 計算顯示區 */
        .result-display {
            background: rgba(26, 42, 108, 0.03);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            margin-top: 20px;
        }

        #pathText { font-size: 0.85em; color: #b2bec3; margin-bottom: 10px; display: block; }
        #finalRelation { font-size: 1.8em; font-weight: 600; color: var(--primary-dark); }

        /* 兩欄佈局 */
        .main-grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 30px;
        }

        /* 紅包美學 */
        .envelope-wrap {
            perspective: 1000px;
        }

        .envelope-modern {
            width: 200px;
            height: 320px;
            background: linear-gradient(145deg, #d44848, #c0392b);
            margin: auto;
            border-radius: 12px;
            padding: 20px;
            color: #f1c40f;
            box-shadow: 0 20px 40px rgba(192, 57, 43, 0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .env-border {
            border: 1px solid rgba(241, 196, 15, 0.4);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #envReceiver { writing-mode: vertical-rl; font-size: 1.4em; letter-spacing: 6px; }
        #envSender { position: absolute; bottom: 15px; left: 15px; font-size: 0.7em; opacity: 0.8; }

        /* 搜尋與列表 */
        .search-input {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 2px solid #eee;
            padding: 15px 0;
            font-size: 1.1em;
            outline: none;
            transition: 0.3s;
        }

        .search-input:focus { border-color: var(--accent-gold); }

        .item {
            padding: 15px 0;
            border-bottom: 1px solid #f1f1f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .tag { font-size: 0.7em; padding: 4px 10px; border-radius: 20px; background: #eee; color: #777; }
        .hidden { display: none; }
        .nested-list { padding-left: 15px; margin-top: 10px; border-left: 1px dashed #ddd; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>The Kinship</h1>
        <p>親屬關係數位典藏與智能計算</p>
    </header>

    <div class="glass-card">
        <div class="section-title">智能路徑引擎</div>
        <div class="btn-grid">
            <button class="node" onclick="addPath('父', '父')">父系</button>
            <button class="node" onclick="addPath('母', '母')">母系</button>
            <button class="node" onclick="addPath('兄', '兄')">兄/姊</button>
            <button class="node" onclick="addPath('弟', '弟')">弟/妹</button>
            <button class="node" onclick="addPath('子', '子')">子/女</button>
            <button class="node" onclick="addPath('妻', '配偶')">姻親</button>
            <button class="node btn-reset" onclick="resetCalc()">重設</button>
        </div>
        
        <div class="result-display">
            <span id="pathText">WAITING FOR INPUT...</span>
            <div id="finalRelation">請開始點選關係</div>
            <div id="legalDegree" style="font-size: 0.8em; color: #999; margin-top: 10px; letter-spacing: 1px;"></div>
        </div>
    </div>

    <div class="main-grid">
        <div class="glass-card">
            <div class="section-title">數位百科檢索</div>
            <input type="text" id="searchInput" class="search-input" placeholder="輸入關鍵字...">
            <div id="treeContent" style="margin-top: 20px;">
                <div class="item"><span class="relation">直系血親</span><span class="tag">二親等內</span></div>
                <div class="nested-list">
                    <div class="item"><span>父母 / 祖父母</span></div>
                </div>
                <div class="item"><span class="relation">旁系堂表</span><span class="tag">四親等</span></div>
                <div class="nested-list">
                    <div class="item"><span>堂兄弟 / 表兄弟</span></div>
                </div>
            </div>
        </div>

        <div class="glass-card" style="text-align: center;">
            <div class="section-title">紅包美學預覽</div>
            <div class="envelope-wrap">
                <div class="envelope-modern">
                    <div class="env-border">
                        <div id="envReceiver">祝 尊親 誌喜</div>
                        <div id="envSender">本人 敬賀</div>
                    </div>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 0.8em; color: #999;">正式場合之書面建議</p>
        </div>
    </div>
</div>

<script>
    let pathKeys = [];
    let pathLabels = [];

    const relationData = {
        "父,兄": { name: "伯父", formal: ["伯父大人", "賢姪"], degree: "三親等" },
        "父,弟": { name: "叔叔", formal: ["叔父大人", "賢姪"], degree: "三親等" },
        "父,兄,子": { name: "堂兄弟姊妹", formal: ["堂兄弟", "堂兄/弟"], degree: "四親等" },
        "父,弟,子": { name: "堂兄弟姊妹", formal: ["堂兄弟", "堂兄/弟"], degree: "四親等" },
        "母,兄": { name: "大舅", formal: ["舅父大人", "外甥"], degree: "三親等" },
        "母,弟": { name: "小舅", formal: ["舅父大人", "外甥"], degree: "三親等" },
        "母,兄,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" },
        "母,姊,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" },
        "母,弟,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" },
        "母,妹,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" },
        "父,姊,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" },
        "父,妹,子": { name: "表兄弟姊妹", formal: ["表兄弟", "表兄/弟"], degree: "四親等" }
    };

    function addPath(key, label) {
        pathKeys.push(key);
        pathLabels.push(label);
        document.getElementById('pathText').innerText = pathLabels.join(' 〉');
        
        let searchKey = pathKeys.join(',');
        let result = relationData[searchKey];
        
        if (result) {
            document.getElementById('finalRelation').innerText = result.name;
            document.getElementById('legalDegree').innerText = `LEGALLY: ${result.degree}`;
            document.getElementById('envReceiver').innerText = `祝 ${result.formal[0]} 誌喜`;
            document.getElementById('envSender').innerText = `${result.formal[1]} 敬賀`;
            
            // 同步更新搜尋
            searchInput.value = result.name;
            searchInput.dispatchEvent(new Event('input'));
        } else {
            document.getElementById('finalRelation').innerText = "CALCULATING...";
        }
    }

    function resetCalc() {
        pathKeys = []; pathLabels = [];
        document.getElementById('pathText').innerText = "WAITING FOR INPUT...";
        document.getElementById('finalRelation').innerText = "請開始點選關係";
        document.getElementById('legalDegree').innerText = "";
        document.getElementById('envReceiver').innerText = "祝 尊親 誌喜";
        document.getElementById('envSender').innerText = "本人 敬賀";
        searchInput.value = "";
        searchInput.dispatchEvent(new Event('input'));
    }

    const searchInput = document.getElementById('searchInput');
    const items = document.querySelectorAll('.item');

    searchInput.addEventListener('input', function() {
        const query = this.value;
        items.forEach(item => {
            const text = item.innerText;
            if (query === "") {
                item.style.opacity = "1";
            } else if (text.includes(query)) {
                item.style.opacity = "1";
                item.style.color = "var(--accent-gold)";
            } else {
                item.style.opacity = "0.2";
                item.style.color = "var(--text-main)";
            }
        });
    });
</script>

</body>
</html>
