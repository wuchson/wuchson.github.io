<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµ‚æ¥µè¦ªå±¬é—œä¿‚ç™¾ç§‘ & ç¦®å„€è¨ˆç®—æ©Ÿ</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e67e22;
            --red: #c0392b;
            --green: #27ae60;
            --line: #d1d8e0;
            --bg: #f8f9fa;
        }

        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--primary); line-height: 1.6; }
        .wrapper { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        
        header { text-align: center; margin-bottom: 30px; }
        .section-title { background: var(--primary); color: white; padding: 10px 15px; border-radius: 8px; margin-top: 30px; font-weight: bold; }
        
        /* æœå°‹èˆ‡è¨ˆç®—æ©Ÿ UI */
        .search-box { width: 100%; padding: 12px; border: 2px solid var(--line); border-radius: 10px; font-size: 16px; margin-bottom: 20px; box-sizing: border-box; outline: none; transition: 0.3s; }
        .search-box:focus { border-color: var(--accent); }

        .calc-container { padding: 20px; border: 2px dashed var(--accent); border-radius: 15px; background: #fffcf9; margin-bottom: 20px; }
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        button { border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }

        /* ç´…åŒ…ç”Ÿæˆå™¨ */
        .envelope-box { display: flex; gap: 20px; align-items: center; justify-content: center; padding: 20px; background: #eee; border-radius: 15px; flex-wrap: wrap; }
        .envelope { width: 160px; height: 280px; background: var(--red); border-radius: 10px; position: relative; color: #f1c40f; padding: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .envelope-inner { border: 1px solid #f1c40f; height: 100%; display: flex; flex-direction: column; justify-content: space-between; padding: 10px; }

        /* åˆ—è¡¨æ¨£å¼ */
        .nested-list { padding-left: 20px; border-left: 2px solid var(--line); margin: 10px 0; }
        .item { background: white; border: 1px solid #ddd; padding: 10px 15px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; cursor: pointer; }
        .item:hover { background: #fffbf0; border-color: var(--accent); }
        .level-tag { font-size: 0.75em; padding: 3px 8px; border-radius: 4px; color: white; margin-right: 10px; }
        .tag-up { background: #3498db; }
        .tag-side { background: #9b59b6; }
        .tag-down { background: #27ae60; }
        .tag-self { background: var(--red); }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; font-size: 0.9em; }
        th { background: #f2f2f2; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="wrapper">
    <header>
        <h1>ğŸ® çµ‚æ¥µè¦ªå±¬é—œä¿‚ç™¾ç§‘</h1>
        <p>ä¹æ—æº¯æº â€¢ é—œä¿‚è¨ˆç®— â€¢ ç´…åŒ…ç¦®å„€</p>
    </header>

    <div class="section-title">âš¡ é—œä¿‚è·¯å¾‘è¨ˆç®—æ©Ÿ</div>
    <div class="calc-container">
        <div style="font-size: 1.1em; margin-bottom: 10px;">
            è·¯å¾‘ï¼š<span id="pathText" style="color: var(--accent); font-weight: bold;">(è«‹é»é¸ä¸‹æ–¹é—œä¿‚)</span>
        </div>
        <div class="btn-group">
            <button onclick="addPath('çˆ¶', 'çˆ¶/æ¯')" class="tag-up">çˆ¶/æ¯</button>
            <button onclick="addPath('å…„', 'å…„/å§Š')" class="tag-side">å…„/å§Š</button>
            <button onclick="addPath('å¼Ÿ', 'å¼Ÿ/å¦¹')" class="tag-side">å¼Ÿ/å¦¹</button>
            <button onclick="addPath('å­', 'å­/å¥³')" class="tag-down">å­/å¥³</button>
            <button onclick="resetCalc()" style="background: #95a5a6; color: white;">æ¸…é™¤é‡è¨­</button>
        </div>
        <div style="margin-top: 15px; padding: 10px; background: #eef2f3; border-radius: 8px;">
            è¨ˆç®—ç¨±å‘¼ï¼š<span id="finalRelation" style="font-weight: bold; color: var(--red);">--</span>
        </div>
    </div>

    <div class="section-title">ğŸ§§ ç´…åŒ…æ›¸å¯«æ¨¡æ“¬å™¨</div>
    <div class="envelope-box">
        <div>
            <label>å ´åˆï¼š</label><br>
            <select id="eventContext" onchange="updateEnvelope()" style="padding: 8px; width: 120px; margin-top: 10px;">
                <option value="wedding">çµå©šèªŒå–œ</option>
                <option value="newyear">éå¹´ç´…åŒ…</option>
                <option value="birthday">ç¥å£½è³€ç¦®</option>
            </select>
        </div>
        <div class="envelope">
            <div class="envelope-inner">
                <div id="envReceiver" style="writing-mode: vertical-rl; text-align: right; height: 70%; margin-left: auto; letter-spacing: 5px;">ç¥ â—‹â—‹ å©šå®´èªŒå–œ</div>
                <div id="envSender" style="font-size: 0.7em; text-align: left;">â—‹â—‹ æ•¬è³€</div>
            </div>
        </div>
    </div>

<h1>è¦ªå±¬é—œä¿‚å±¤ç–Šç™¾ç§‘</h1>
        <p>æ¶µè“‹ä¹æ—ã€æ—ç³»ã€å¤–è¦ªèˆ‡é æˆ¿ç¨±å‘¼</p>
    </header>

    <input type="text" id="searchInput" class="search-box" placeholder="è¼¸å…¥ç¨±å‘¼æˆ–é—œä¿‚æœå°‹ï¼ˆå¦‚ï¼šå ‚ã€èˆ…ã€æ›¾...ï¼‰">

    <div id="treeContent">
        <div class="category-title">ã€å®—è¦ª / çˆ¶ç³»ã€‘ä¹æ—äº”ä»£</div>
        <div class="nested-list">
            <div class="item"><span class="relation"><span class="level-tag tag-up">é«˜ç¥–è¼©</span><span class="relation-text">é«˜ç¥–çˆ¶ / é«˜ç¥–æ¯</span></span><span class="desc">çˆºçˆºçš„çˆºçˆº/å¥¶å¥¶</span></div>
            <div class="nested-list">
                <div class="item"><span class="relation"><span class="level-tag tag-up">æ›¾ç¥–è¼©</span><span class="relation-text">æ›¾ç¥–çˆ¶ / æ›¾ç¥–æ¯</span></span><span class="desc">çˆºçˆºçš„çˆ¸çˆ¸/åª½åª½ (å¤ªå…¬/å¤ªå©†)</span></div>
                <div class="nested-list">
                    <div class="item"><span class="relation"><span class="level-tag tag-up">ç¥–è¼©</span><span class="relation-text">ç¥–çˆ¶ / ç¥–æ¯</span></span><span class="desc">çˆ¸çˆ¸çš„çˆ¸çˆ¸/åª½åª½ (çˆºçˆº/å¥¶å¥¶)</span></div>
                    <div class="nested-list">
                        <div class="item"><span class="relation"><span class="level-tag tag-up">çˆ¶è¼©</span><span class="relation-text">çˆ¶è¦ª / æ¯è¦ª</span></span><span class="desc">ç”Ÿèº«çˆ¶æ¯</span></div>
                        <div class="nested-list">
                            <div class="item" style="border: 2px solid #e74c3c;"><span class="relation"><span class="level-tag tag-self">å·±èº«</span><span class="relation-text">æˆ‘è‡ªå·±</span></span><span class="desc">åŸºæº–é»</span></div>
                            <div class="nested-list">
                                <div class="item"><span class="relation"><span class="level-tag tag-down">å­è¼©</span><span class="relation-text">å…’å­ / å¥³å…’</span></span><span class="desc">ç¬¬ä¸€ä»£æ™šè¼©</span></div>
                                <div class="nested-list">
                                    <div class="item"><span class="relation"><span class="level-tag tag-down">å­«è¼©</span><span class="relation-text">å­«å­ / å­«å¥³</span></span><span class="desc">å…’å­çš„å­å¥³</span></div>
                                    <div class="nested-list">
                                        <div class="item"><span class="relation"><span class="level-tag tag-down">æ›¾å­«è¼©</span><span class="relation-text">æ›¾å­« / æ›¾å­«å¥³</span></span><span class="desc">å­«å­çš„å­å¥³</span></div>
                                        <div class="nested-list">
                                            <div class="item"><span class="relation"><span class="level-tag tag-down">ç„å­«è¼©</span><span class="relation-text">ç„å­« / ç„å­«å¥³</span></span><span class="desc">äº”ä»£å­«</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="category-title">ã€æ—ç³»ã€‘æ¥µé æˆ¿åˆ†æ”¯</div>
        <div class="nested-list">
            <div class="item"><span class="relation"><span class="level-tag tag-side">æ—è¼©</span><span class="relation-text">æ—ç¥–çˆ¶ / æ—ç¥–æ¯</span></span><span class="desc">çˆºçˆºçš„å ‚å…„å¼Ÿå§Šå¦¹</span></div>
            <div class="item"><span class="relation"><span class="level-tag tag-side">å ‚è¦ª</span><span class="relation-text">å ‚ä¼¯ / å ‚å” / å ‚å§‘</span></span><span class="desc">çˆ¶è¦ªçš„å ‚å…„å¼Ÿå§Šå¦¹</span></div>
            <div class="nested-list">
                <div class="item"><span class="relation"><span class="level-tag tag-side">å†å¾è¦ª</span><span class="relation-text">å ‚å…„å¼Ÿå§Šå¦¹ (å†å¾å…„å¼Ÿ)</span></span><span class="desc">åŒæ›¾ç¥–çˆ¶ä½†ä¸åŒç¥–çˆ¶</span></div>
                <div class="item"><span class="relation"><span class="level-tag tag-side">æ™šè¼©</span><span class="relation-text">å ‚å§ª / å ‚å¤–ç”¥</span></span><span class="desc">å ‚å…„å¼Ÿå§Šå¦¹çš„å­å¥³</span></div>
            </div>
        </div>

        <div class="category-title">ã€å¤–è¦ª / æ¯ç³»ã€‘</div>
        <div class="nested-list">
            <div class="item"><span class="relation"><span class="level-tag tag-up">å¤–ç¥–è¼©</span><span class="relation-text">å¤–æ›¾ç¥–çˆ¶ / å¤–æ›¾ç¥–æ¯</span></span><span class="desc">æ¯è¦ªçš„ç¥–çˆ¶æ¯</span></div>
            <div class="item"><span class="relation"><span class="level-tag tag-side">è¡¨è¦ª</span><span class="relation-text">è¡¨ä¼¯ / è¡¨å” / è¡¨å§‘</span></span><span class="desc">çˆ¶è¦ªçš„è¡¨å…„å¼Ÿå§Šå¦¹</span></div>
            <div class="item"><span class="relation"><span class="level-tag tag-side">è¡¨è¦ª</span><span class="relation-text">èˆ…å…¬ / å§¨å©†</span></span><span class="desc">æ¯è¦ªçš„èˆ…èˆ…/å§¨åª½</span></div>
        </div>
    </div>
</div>

        </div>
    </div>

    <div class="section-title">ğŸ“– ç¤¾äº¤ç¦®å„€ç¨±è¬‚è¡¨</div>
    <table>
        <thead>
            <tr><th>é—œä¿‚</th><th>å°äººè¬™ç¨± (å®¶/èˆ)</th><th>å°Šç¨±å°æ–¹ (ä»¤)</th><th>æ›¸é¢è‡ªç¨±</th></tr>
        </thead>
        <tbody>
            <tr><td>çˆ¶æ¯</td><td>å®¶åš´ / å®¶æ…ˆ</td><td>ä»¤å°Š / ä»¤å ‚</td><td>å…’ / ğŸ‘§å°å¥³</td></tr>
            <tr><td>å…„å¼Ÿ</td><td>å®¶å…„ / èˆå¼Ÿ</td><td>ä»¤å…„ / ä»¤å¼Ÿ</td><td>æ„šå…„å¼Ÿ</td></tr>
            <tr><td>å­å¥³</td><td>å°å…’ / ğŸ‘§å°å¥³</td><td>ä»¤éƒ / ä»¤æ„›</td><td>çˆ¶/æ¯ç¤º</td></tr>
        </tbody>
    </table>
</div>

<script>
    // 1. è¨ˆç®—æ©Ÿèˆ‡è·¯å¾‘é‚è¼¯
    let pathKeys = [];
    let pathLabels = [];
    
    const relationData = {
        "çˆ¶": { title: "çˆ¶è¦ª/æ¯è¦ª", formal: ["çˆ¶æ¯è¦ª", "å…’/å¥³"] },
        "çˆ¶,çˆ¶": { title: "ç¥–çˆ¶/ç¥–æ¯", formal: ["ç¥–çˆ¶æ¯", "å­«/å­«å¥³"] },
        "çˆ¶,å…„": { title: "ä¼¯çˆ¶/å”å”/å§‘æ¯", formal: ["ä¼¯å”çˆ¶", "å§ª/å§ªå¥³"] },
        "çˆ¶,å­": { title: "è‡ªå·±/å…„å¼Ÿå§Šå¦¹", formal: ["å…„å¼Ÿ/å§Šå¦¹", "å¼Ÿ/å¦¹"] },
        "çˆ¶,å…„,å­": { title: "å ‚å…„å¼Ÿå§Šå¦¹", formal: ["å ‚å…„/å¼Ÿ", "å ‚å¼Ÿ/å…„"] },
        "å­": { title: "å…’å­/å¥³å…’", formal: ["å°å…’/å°å¥³", "çˆ¶/æ¯"] },
        "å­,å­": { title: "å­«å­/å­«å¥³", formal: ["å­«è¼©", "ç¥–çˆ¶/æ¯"] },
        "å…„,å­": { title: "å§ªå­/å§ªå¥³", formal: ["è³¢å§ª", "æ„šä¼¯/å”"] }
    };

    function addPath(key, label) {
        pathKeys.push(key);
        pathLabels.push(label);
        document.getElementById('pathText').innerText = pathLabels.join(' çš„ ');
        
        let searchKey = pathKeys.join(',');
        let result = relationData[searchKey];
        
        if (result) {
            document.getElementById('finalRelation').innerText = result.title;
            updateEnvelope(result.formal);
        } else {
            document.getElementById('finalRelation').innerText = "é—œä¿‚è¼ƒé ï¼Œè«‹åƒè€ƒç™¾ç§‘";
        }
    }

    function resetCalc() {
        pathKeys = []; pathLabels = [];
        document.getElementById('pathText').innerText = "(è«‹é»é¸æŒ‰éˆ•)";
        document.getElementById('finalRelation').innerText = "--";
    }

    // 2. ç´…åŒ…æ›´æ–°é‚è¼¯
    function updateEnvelope(formalPair = ["æŸæŸå¤§äºº", "æŸæŸ"]) {
        const event = document.getElementById('eventContext').value;
        const receiverLine = document.getElementById('envReceiver');
        const senderLine = document.getElementById('envSender');
        
        const eventSuffix = { "wedding": "å©šå®´èªŒå–œ", "newyear": "æ­²æœ«å‰ç¥¥", "birthday": "ç¦å£½é›™å…¨" };
        receiverLine.innerText = `ç¥ ${formalPair[0]} ${eventSuffix[event]}`;
        senderLine.innerText = `${formalPair[1]} æ•¬è³€`;
    }

    // 3. æœå°‹é‚è¼¯
    document.getElementById('searchInput').addEventListener('input', function() {
        const query = this.value;
        const items = document.querySelectorAll('.item');
        items.forEach(item => {
            const text = item.innerText;
            if (text.includes(query) && query !== "") {
                item.style.display = 'flex';
                item.style.background = '#fffbf0';
            } else if (query === "") {
                item.style.display = 'flex';
                item.style.background = 'white';
            } else {
                item.style.display = 'none';
            }
        });
    });
</script>

</body>
</html>
